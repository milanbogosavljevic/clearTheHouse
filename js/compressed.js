this.system=this.system||{},function(){"use strict";const a=function(a){this._init(a)},b=a.prototype;b._game=null,b._enemies=null,b._activeEnemies=null,b._maxNumberOfActiveEnemies=null,b._maxNumberOfEnemies=null,b._enemiesCounter=null,b._enemiesHealth=null,b._enemiesDamage=null,b._enemyAmmo=null,b._enemyBullets=null,b._healthColor=null,b._movementSpeed=null,b._init=function(a){this._game=a,this._enemies=[],this._activeEnemies=[],this._enemyAmmo=[],this._enemyBullets=[],this._movementSpeed=0,this._enemiesCounter=0},b._addEnemy=function(){this._enemiesCounter++;let a;0<this._enemies.length?(a=this._enemies[0],this._enemies.splice(0,1),a.visible=!0):(a=new system.Enemy,this._game.addEnemy(a)),a.updateColor(this._healthColor),a.updateStartHealth(this._enemiesHealth),a.reset();const b=!0===system.CustomMethods.getRandomBool()?system.CustomMethods.getRandomNumberFromTo(-100,0):system.CustomMethods.getRandomNumberFromTo(this._game.LEVEL_WIDTH,this._game.LEVEL_WIDTH+100),c=!0===system.CustomMethods.getRandomBool()?system.CustomMethods.getRandomNumberFromTo(-100,0):system.CustomMethods.getRandomNumberFromTo(this._game.LEVEL_HEIGHT,this._game.LEVEL_HEIGHT+100);a.x=b,a.y=c;const d=system.CustomMethods.getRandomNumberFromTo(50,500);a.setShootinCooldown(d),this._activeEnemies.push(a),console.log("add enemy")},b._checkRightLeft=function(a,b){const c=this._activeEnemies[a],d=c.x,e=c.y,f=80;let g=!0,h=this._activeEnemies.length-1;for(h;-1<h;h--)if(h!==a){const a=this._activeEnemies[h],c=a.x,i=a.y;let j="right"===b?c-d:d-c;const k=Math.abs(e-i);if(k<f&&j<f&&0<j){g=!1;break}}return g},b._checkUpDown=function(a,b){const c=this._activeEnemies[a],d=c.x,e=c.y,f=80;let g=!0,h=this._activeEnemies.length-1;for(h;-1<h;h--)if(h!==a){const a=this._activeEnemies[h],c=a.x,i=a.y;let j="up"===b?i-e:e-i;const k=Math.abs(d-c);if(k<f&&j<f&&0<j){g=!1;break}}return g},b._getHealthColor=function(){return this._healthColor},b.setEnemiesParameters=function(a){this._enemiesDamage=a.enemiesDamage,this._maxNumberOfActiveEnemies=a.maxNumberOfActiveEnemies,this._maxNumberOfEnemies=a.maxNumberOfEnemies,this._healthColor=a.color,this._movementSpeed=a.movementSpeed,this._enemiesHealth=a.enemiesHealth},b.getEnemiesDamage=function(){return this._enemiesDamage},b.addEnemies=function(a){for(let b=0;b<a;b++)this._addEnemy()},b.manageEnemies=function(){this._enemiesCounter<this._maxNumberOfEnemies?this._activeEnemies.length<this._maxNumberOfActiveEnemies&&this._addEnemy():0===this._activeEnemies.length&&(console.log("no more enemies"),this._enemiesCounter=0,this._game.levelPassed())},b.resetCounter=function(){this._enemiesCounter=0},b.clearEnemies=function(){let a=this._activeEnemies.length-1;for(a;-1<a;a--){const b=this._activeEnemies[a];b.visible=!1,this._activeEnemies.splice(a,1),this._enemies.push(b),console.log(`clear enemy`)}},b.checkHitFromPlayer=function(a,b){let c=this._activeEnemies.length-1;for(c;-1<c;c--){const d=this._activeEnemies[c],e=d.getDimension();if(a.x>d.x&&a.x<d.x+e.width&&a.y>d.y&&a.y<d.y+e.height){if(d.decreaseHealth(b),1>d.getHealth()){d.visible=!1,this._activeEnemies.splice(c,1),this._enemies.push(d),this._game.updateEnemiesCounter();const a=d.x+e.width/2,b=d.y+e.height/2,f=this._getHealthColor();this._game.showParticles(a,b,f,40,10,-200,200),system.SoundManager.play("enemyExplosionSound",2)}return!0}}return!1},b.enemyShoot=function(){let a=this._activeEnemies.length-1;if(0>a)return;let b;for(a;-1<a;a--){const c=this._activeEnemies[a],d=c.getDimension();!0===c.canShoot()&&(system.SoundManager.play("enemyShootSound"),0<this._enemyAmmo.length?(b=this._enemyAmmo[0],this._enemyAmmo.splice(0,1),b.visible=!0):(b=system.CustomMethods.makeImage("bullet",!1,!1),this._game.addEnemyBullet(b)),b.x=c.x+d.width/2-4,b.y=c.y+d.height/2-4,this._enemyBullets.push(b),this._game.moveEnemyBullet(b,c.bulletPoint,c.getBulletSpeed()))}},b.checkActiveBullets=function(a){let b=this._enemyBullets.length-1;if(!(0>b)){const c=a.getDimension();for(b;-1<b;b--){const d=this._enemyBullets[b];d.x>this._game.LEVEL_WIDTH||0>d.x||0>d.y||d.y>this._game.LEVEL_HEIGHT?(this._enemyBullets.splice(b,1),this._enemyAmmo.push(d),d.visible=!1):d.x>a.x&&d.x<a.x+c.width&&d.y>a.y&&d.y<a.y+c.height&&(this._enemyBullets.splice(b,1),this._enemyAmmo.push(d),d.visible=!1,this._game.enemyHitsPlayer(this.getEnemiesDamage()))}}},b.moveActiveEnemies=function(a,b,c){let d=this._activeEnemies.length-1;if(!(0>d))for(d;-1<d;d--){const e=this._activeEnemies[d],f=this._movementSpeed,g=Math.abs(a-e.x),h=Math.abs(b-e.y);a>e.x?!0===this._checkRightLeft(d,"right")&&g>f&&(e.x+=f):a<e.x&&!0===this._checkRightLeft(d,"left")&&g>f&&(e.x-=f),b>e.y&&!0===this._checkUpDown(d,"up")&&h>f&&(e.y+=f),b<e.y&&!0===this._checkUpDown(d,"down")&&h>f&&(e.y-=f);const i=e.getDimension();let j=180*Math.atan2(e.y+i.height/2-(b+c.height/2),e.x+i.width/2-(a+c.width/2))/Math.PI;j-=90,e.rotateGun(Math.round(j)),e.incrementShootingCooldown()}},system.EnemiesController=a}();this.system=this.system||{},function(){"use strict";const a=function(){this.Container_constructor(),this._init()},b=createjs.extend(a,createjs.Container);b._enemiesCounter=null,b._enemiesCounterNum=null,b._enemiesTotal=null,b._init=function(){const a=system.CustomMethods.makeImage("enemiesCounterBack",!1,!1);this.addChild(a),this.regX=a.image.width/2,this.regY=a.image.height/2,this._enemiesCounterNum=0;let b=this._enemiesCounter=system.CustomMethods.makeText(this._enemiesCounterNum,"44px Teko","#000000","center","middle");b.x=38,b.y=44;let c=this._enemiesTotal=system.CustomMethods.makeText("0","44px Teko","#000000","center","middle");c.x=113,c.y=b.y,this.addChild(b,c)},b.updateCounter=function(){this._enemiesCounterNum++,this._enemiesCounter.text=this._enemiesCounterNum},b.resetCounter=function(){this._enemiesCounterNum=-1,this.updateCounter()},b.updateTotal=function(a){this._enemiesTotal.text=a},system.EnemiesCounter=createjs.promote(a,"Container")}();this.system=this.system||{},function(){"use strict";const a=function(){this.Container_constructor(),this._init()},b=createjs.extend(a,createjs.Container);b._speed=null,b._width=null,b._height=null,b._gun=null,b._gunImage=null,b._bulletSpeed=null,b._damage=null,b._shootingCooldown=null,b._shootingCooldownCounter=null,b._startHealth=null,b._health=null,b._healthShape=null,b._body=null,b._healthColor=null,b.bulletPoint=null,b._init=function(){this._healthColor="#000000";const a=64,b=64,c=this._body=new createjs.Shape(new createjs.Graphics().setStrokeStyle(8).beginStroke("#ffffff").drawRect(0,0,a,b));c.cache(0,0,a,b),c.mouseEnabled=!1;const d=a-8,e=b-8,f=this._healthShape=new createjs.Shape(new createjs.Graphics().beginFill(this._healthColor).drawRect(0,0,d,e));f.cache(0,0,d,e),f.x=4,f.y=4,f.originalWidth=d,f.originalHeight=e,f.mouseEnabled=!1,this.addChild(c,f);const g=this._gunImage=system.CustomMethods.makeImage("enemyGun",!1,!1),h=this._gun=new createjs.Container;h.regX=g.image.width/2,h.regY=g.image.height,h.x=c.bitmapCache.width/2,h.y=c.bitmapCache.height/2;const i=system.CustomMethods.makeImage("enemyGunOverlay",!1,!0);i.x=g.image.width/2,i.y=g.image.height;const j=this.bulletPoint=system.CustomMethods.makeImage("bullet",!1,!1);j.x=4,j.y=-4400,j.visible=!1,h.addChild(g,i,j),this.addChild(h),this._bulletSpeed=3e3,this._width=c.bitmapCache.width,this._height=c.bitmapCache.height,this._shootingCooldownCounter=0,this._startHealth=0,this._health=this._startHealth,this.mouseEnabled=!1},b._updateBody=function(){this._body.uncache(),this._body.graphics.clear().setStrokeStyle(8).beginStroke(this._healthColor).drawRect(0,0,64,64),this._body.cache(0,0,64,64)},b._updateHealthBar=function(a,b,c,d){this._healthShape.uncache(),this._healthShape.graphics.clear().beginFill(this._healthColor).drawRect(a,b,c,d),this._healthShape.cache(a,b,c,d)},b.updateStartHealth=function(a){this._startHealth=a},b.updateColor=function(a){this._healthColor!==a&&(this._healthColor=a,this._updateBody())},b.reset=function(){this._health=this._startHealth,this._updateHealthBar(0,0,this._healthShape.originalWidth,this._healthShape.originalHeight)},b.decreaseHealth=function(a){this._health-=a;const b=system.CustomMethods.getPercentage(this._startHealth,this._health),c=this._healthShape.originalWidth,d=this._healthShape.originalHeight/100*b,e=this._healthShape.originalHeight-d;this._updateHealthBar(0,e,c,d)},b.getHealth=function(){return this._health},b.incrementShootingCooldown=function(){this._shootingCooldownCounter++},b.setShootinCooldown=function(a){this._shootingCooldown=a},b.canShoot=function(){let a=!1;return this._shootingCooldownCounter>this._shootingCooldown&&(a=!0,this._shootingCooldownCounter=0),a},b.rotateGun=function(a){this._gun.rotation=a},b.getBulletSpeed=function(){return this._bulletSpeed},b.getDamage=function(){return this._damage},b.getDimension=function(){return{width:this._width,height:this._height}},system.Enemy=createjs.promote(a,"Container")}();this.system=this.system||{},function(){"use strict";const a=function(){this.Container_constructor(),this._init()},b=createjs.extend(a,createjs.Container);b._player=null,b._playerMovement=null,b._playerAmmo=null,b._playerBullets=null,b._enemiesController=null,b._enemiesCounter=null,b._level=null,b._currentLevel=null,b._numberOfLevels=null,b._fpsText=null,b._waveInfo=null,b._upgradePanel=null,b._playerStatsPanel=null,b._gameoverPanel=null,b._cursor=null,b._playerCountiniouslyShooting=null,b._gameBeatenInterval=null,b._gameOver=!0,b._CAMERA_WIDTH=null,b._CAMERA_HEIGHT=null,b.LEVEL_WIDTH=null,b.LEVEL_HEIGHT=null,b._PLAYER_LEFT_BORDER=null,b._PLAYER_RIGHT_BORDER=null,b._PLAYER_UP_BORDER=null,b._PLAYER_DOWN_BORDER=null,b._LEFT_AREA_BORDER=null,b._RIGHT_AREA_BORDER=null,b._UP_AREA_BORDER=null,b._DOWN_AREA_BORDER=null,b._init=function(){this._CAMERA_WIDTH=stage.canvas.width,this._CAMERA_HEIGHT=stage.canvas.height,this._playerCountiniouslyShooting=!1,this._enemiesController=new system.EnemiesController(this),this._playerAmmo=[],this._playerBullets=[],this._currentLevel=1,this._numberOfLevels=system.LevelParameters.getNumberOfLevels();const a=this._waveInfo=new system.WaveInfo;a.x=this._CAMERA_WIDTH/2,a.y=this._CAMERA_HEIGHT/2,a.scaleX=a.scaleY=0;let b=system.CustomMethods.makeImage("info",!0,!1);b.addEventListener("click",()=>{b.removeAllEventListeners(),this.removeChild(b),b=null,this._setLevelParameters(),system.SoundManager.play("backgroundMusic",.5,-1)}),this._level=new createjs.Container;const c=system.CustomMethods.makeImage("background",!0),d=this._player=new system.Player;d.x=960,d.y=540,this._setPlayerMovement(),this._level.addChild(c,d),this.addChild(this._level),this.addChild(a);const e=this._enemiesCounter=new system.EnemiesCounter;e.x=960,e.y=60,this.addChild(e);const f=this._player.getStartingUpgradeValues(),g=this._upgradePanel=new system.UpgradePanel(this,f);g.x=695,g.y=-300,g.visible=!1,this.addChild(g);const h={damage:this._player.getDamage(),health:this._player.getHealth(),speed:this._player.getSpeed(),cooldown:this._player.getCooldown()},i=this._playerStatsPanel=new system.PlayerStats(h);i.x=10,i.y=10,this.addChild(i);const j=this._player.getHighscore(),k=this._gameoverPanel=new system.GameoverPanel(this,j);k.x=695,k.y=-300,k.visible=!1,this.addChild(k),this.addChild(b),this.LEVEL_WIDTH=c.image.width,this.LEVEL_HEIGHT=c.image.height,this._LEFT_AREA_BORDER=this._CAMERA_WIDTH/2,this._RIGHT_AREA_BORDER=this.LEVEL_WIDTH-this.LEVEL_WIDTH/4,this._UP_AREA_BORDER=this._CAMERA_HEIGHT/2,this._DOWN_AREA_BORDER=this.LEVEL_HEIGHT-this.LEVEL_HEIGHT/4;const l=d.getDimension();this._PLAYER_LEFT_BORDER=0,this._PLAYER_RIGHT_BORDER=this.LEVEL_WIDTH-l.width,this._PLAYER_UP_BORDER=0,this._PLAYER_DOWN_BORDER=this.LEVEL_HEIGHT-l.height,document.onkeydown=a=>{this._handleKey(a.key,!0)},document.onkeyup=a=>{this._handleKey(a.key,!1)},this._addButtons();const m=this._cursor=system.CustomMethods.makeImage("cursor",!1,!0);this.addChild(m),stage.on("stagemousemove",a=>{m.x=a.stageX,m.y=a.stageY;const b=this._player.getDimension();let c=this._player.localToGlobal(this.x,this.y),d=180*Math.atan2(c.y+b.height/2-a.stageY,c.x+b.width/2-a.stageX)/Math.PI;d-=90,this._player.rotateGun(Math.round(d))}),c.on("mousedown",()=>{this._playerCountiniouslyShooting=!0}),c.on("pressup",()=>{this._playerCountiniouslyShooting=!1}),setInterval(()=>{!1===this._gameOver&&(this._enemiesController.enemyShoot(),this._enemiesController.manageEnemies())},1e3),this._registerSounds()},b._registerSounds=function(){system.SoundManager.registerSound("backgroundMusic"),system.SoundManager.registerSound("shootSound"),system.SoundManager.registerSound("enemyShootSound"),system.SoundManager.registerSound("gameOverSound"),system.SoundManager.registerSound("upgradeSelectSound"),system.SoundManager.registerSound("enemyExplosionSound"),system.SoundManager.registerSound("playerExplosionSound"),system.SoundManager.registerSound("enemyHitSound"),system.SoundManager.registerSound("playerHitSound")},b._playerShooting=function(){!0===this._playerCountiniouslyShooting&&!0===this._player.canShoot()&&this._playerShoot()},b._showGameoverPanel=function(a){const b=this._playerStatsPanel.getScore(),c=this._player.getHighscore();b>c&&(this._gameoverPanel.updateTextField("highscore",b),this._player.setHighscore(b)),this._gameoverPanel.updateTextField("score",b),this._gameoverPanel.enableButtons(!1);let d;!0===a?(d=200,this._gameoverPanel.visible=!0):d=-300,createjs.Tween.get(this._gameoverPanel).wait(1e3).to({y:d},500,createjs.Ease.quadInOut).call(()=>{!1===a?(this._currentLevel=1,this._setLevelParameters(),this._resetGame(),this._gameoverPanel.visible=!1):(this._gameoverPanel.enableButtons(!0),system.SoundManager.play("gameOverSound"))})},b._showUpgradePanel=function(a,b){this._upgradePanel.enableButtons(!1);let c;!0===a?(c=200,this._upgradePanel.visible=!0):c=-300,createjs.Tween.get(this._upgradePanel).wait(500).to({y:c},500,createjs.Ease.quadInOut).call(()=>{if(this._upgradePanel.enableButtons(a),!1===a){this._setLevelParameters(),this._upgradePanel.visible=!1;const a=this._player.getUpgradeValue(b);!1===a?this._upgradePanel.hideButton(b):this._upgradePanel.updateTextField(b,a)}})},b._showWaveInfo=function(a){this._waveInfo.updateTextFields(a),this._waveInfo.visible=!0,createjs.Tween.get(this._waveInfo).to({scaleX:1,scaleY:1},500,createjs.Ease.quadIn).wait(5e3).call(()=>{createjs.Tween.get(this._waveInfo).to({scaleX:0,scaleY:0},500,createjs.Ease.quadOut).call(()=>{this._enemiesCounter.resetCounter(),this._enemiesCounter.updateTotal(a.numberOfEnemies),this._waveInfo.visible=!1,this._gameOver=!1})})},b._setLevelParameters=function(){console.log(`setting parameters for level ${this._currentLevel}`);const a=system.LevelParameters.getParametersForLevel(this._currentLevel);this._enemiesController.setEnemiesParameters(a);const b={waveNumber:this._currentLevel,numberOfEnemies:a.maxNumberOfEnemies,numberOfActiveEnemies:a.maxNumberOfActiveEnemies,enemiesDamage:a.enemiesDamage,enemiesHealth:a.enemiesHealth};this._showWaveInfo(b)},b._addButtons=function(){const a=system.CustomMethods.makeImage("fsButton",!0,!1);let b=new system.Button(a);b.addEventListener("click",()=>{system.CustomMethods.toggleFullScreen()}),b.x=1885,b.y=35,this.addChild(b);const c=system.CustomMethods.makeImage("soundButton",!0,!1);let d=new system.Button(c);d.addEventListener("click",()=>{system.SoundManager.muteAllSounds(),d.alpha=!0===createjs.Sound.muted?.5:1}),d.x=1820,d.y=35,this.addChild(d)},b._playerShoot=function(){system.SoundManager.play("shootSound");const a=this._player.getDimension();let b=this._player.localToGlobal(this.x,this.y),c=180*Math.atan2(b.y+a.height/2-this._cursor.y,b.x+a.width/2-this._cursor.x)/Math.PI;c-=90,this._player.rotateGun(Math.round(c));let d;0<this._playerAmmo.length?(d=this._playerAmmo[0],this._playerAmmo.splice(0,1)):(d=system.CustomMethods.makeImage("bullet",!1,!1),d.visible=!1,this._level.addChild(d)),d.x=this._player.x+a.width/2-4,d.y=this._player.y+a.height/2-4;let e=this._player.bulletPoint.localToGlobal(this.x,this.y),f=Math.round(Math.abs(this._level.x)+e.x),g=Math.round(Math.abs(this._level.y)+e.y);this._playerBullets.push(d);let h=0,i=!0,j=this._level.globalToLocal(this._cursor.x,this._cursor.y),k=10;!0===this._playerMovement.left&&(j.x<this._player.x?k=30:k=5),!0===this._playerMovement.right&&(j.x<this._player.x?k=5:k=30),!0===this._playerMovement.down&&(j.y<this._player.y?k=5:k=30),!0===this._playerMovement.up&&(j.y<this._player.y?k=30:k=5);let l=createjs.Tween.get(d).to({x:f,y:g},this._player.getBulletSpeed());this._player.doShootAnimation(),l.addEventListener("change",a=>{!0===i&&(0===h?h=a.timeStamp:a.timeStamp-h>k&&(d.visible=!0,i=!1,l.removeAllEventListeners()))})},b._handleKey=function(a,b){("a"===a||"A"===a)&&this._playerMovement.left!==b&&(this._playerMovement.left=b),("d"===a||"D"===a)&&this._playerMovement.right!==b&&(this._playerMovement.right=b),("w"===a||"W"===a)&&this._playerMovement.up!==b&&(this._playerMovement.up=b),("s"===a||"S"===a)&&this._playerMovement.down!==b&&(this._playerMovement.down=b)},b._setPlayerMovement=function(){this._playerMovement={left:!1,right:!1,up:!1,down:!1}},b._movePlayer=function(){const a=this._player.getSpeed();!0===this._playerMovement.left&&this._player.x>this._PLAYER_LEFT_BORDER&&(this._player.x-=a),!0===this._playerMovement.right&&this._player.x<this._PLAYER_RIGHT_BORDER&&(this._player.x+=a),!0===this._playerMovement.up&&this._player.y>this._PLAYER_UP_BORDER&&(this._player.y-=a),!0===this._playerMovement.down&&this._player.y<this._PLAYER_DOWN_BORDER&&(this._player.y+=a)},b._moveEnemies=function(){this._enemiesController.moveActiveEnemies(this._player.x,this._player.y,this._player.getDimension())},b._moveLevel=function(){const a=this._player.getSpeed();!0===this._playerMovement.right&&this._player.x>this._LEFT_AREA_BORDER&&this._level.x>-this._CAMERA_WIDTH&&(this._level.x-=a),!0===this._playerMovement.left&&this._player.x<this._RIGHT_AREA_BORDER&&0>this._level.x&&(this._level.x+=a),!0===this._playerMovement.down&&this._player.y>this._UP_AREA_BORDER&&this._level.y>-this._CAMERA_HEIGHT&&(this._level.y-=a),!0===this._playerMovement.up&&this._player.y<this._DOWN_AREA_BORDER&&0>this._level.y&&(this._level.y+=a)},b._onMovePlayer=function(a,b){this._playerMovement[a]=b},b._checkIfEnemyHitsPlayer=function(){this._enemiesController.checkActiveBullets(this._player)},b._checkEnemyHits=function(){let a=this._playerBullets.length-1;if(!(0>a))for(a;-1<a;a--){const b=this._playerBullets[a];if(b.x>this.LEVEL_WIDTH||0>b.x||0>b.y||b.y>this.LEVEL_HEIGHT)this._playerAmmo.push(b),this._playerBullets.splice(a,1),b.visible=!1;else{const c=this._player.getDamage();!0===this._enemiesController.checkHitFromPlayer(b,c)&&(system.SoundManager.play("enemyHitSound",.3),this._playerAmmo.push(b),this._playerBullets.splice(a,1),b.visible=!1,this._playerStatsPanel.increaseScore(c))}}},b._shakeStage=function(){createjs.Tween.get(this).to({x:5,y:-5},50).to({x:-5,y:5},50).to({x:5,y:-5},50).to({x:-5,y:5},50).to({x:0,y:0},50)},b._updateFps=function(){this._fpsText.text=Math.round(createjs.Ticker.getMeasuredFPS())},b._resetGame=function(){this._player.resetPlayer(),this._player.resetUpgrades(),this._player.visible=!0;const a={damage:this._player.getDamage(),health:this._player.getHealth(),speed:this._player.getSpeed(),cooldown:this._player.getCooldown()};this._playerStatsPanel.resetStats(a),this._enemiesController.clearEnemies(),this._enemiesController.resetCounter(),this._enemiesController.addEnemies(3),this._enemiesCounter.resetCounter();const b=this._player.getStartingUpgradeValues();this._upgradePanel.resetPanel(b)},b._showCongratulationsAnimation=function(a){!0===a?this._gameBeatenInterval=setInterval(()=>{const a=system.CustomMethods.getRandomNumberFromTo(Math.abs(this._level.x),this._CAMERA_WIDTH+Math.abs(this._level.x)),b=system.CustomMethods.getRandomNumberFromTo(Math.abs(this._level.y),this._CAMERA_HEIGHT+Math.abs(this._level.y)),c=system.LevelParameters.getRandomColor();this.showParticles(a,b,c,80,10,-400,400)},1500):(clearInterval(this._gameBeatenInterval),this._gameBeatenInterval=null)},b.onUpgradeSelected=function(a){system.SoundManager.play("upgradeSelectSound");this._player[`increase${a}`](),this._showUpgradePanel(!1,a);const b=`get${a.charAt(0).toUpperCase()+a.slice(1)}`;this._playerStatsPanel.updateTextField(a,this._player[b]())},b.showParticles=function(a,b,c,d,e,f,g){system.CustomMethods.addParticleAnimation(a,b,c,d,e,f,g,this._level)},b.addEnemyBullet=function(a){this._level.addChild(a)},b.addEnemy=function(a){this._level.addChild(a)},b.moveEnemyBullet=function(a,b,c){let d=b.localToGlobal(this.x,this.y),e=Math.round(Math.abs(this._level.x)+d.x),f=Math.round(Math.abs(this._level.y)+d.y);createjs.Tween.get(a).to({x:e,y:f},c)},b.levelPassed=function(){this._gameOver=!0,this._currentLevel++,this._currentLevel>this._numberOfLevels?(this._showGameoverPanel(!0),this._showCongratulationsAnimation(!0)):this._showUpgradePanel(!0)},b.enemyHitsPlayer=function(a){if(this._player.decreaseHealth(a),this._playerStatsPanel.updateTextField("health",this._player.getHealth()),this._shakeStage(),system.SoundManager.play("playerHitSound"),1>this._player.getHealth()){this._player.visible=!1,this._gameOver=!0;const a=this._player.getDimension(),b=this._player.x+a.width/2,c=this._player.y+a.height/2,d=this._player.getHealthColor();this.showParticles(b,c,d,80,10,-400,400),this._showGameoverPanel(!0),system.SoundManager.play("playerExplosionSound"),console.log("game over")}},b.updateEnemiesCounter=function(){this._enemiesCounter.updateCounter()},b.onReset=function(){this._showGameoverPanel(!1),null!==this._gameBeatenInterval&&this._showCongratulationsAnimation(!1)},b.render=function(a){!1===this._gameOver&&(this._movePlayer(),this._moveEnemies(),this._moveLevel(),this._checkIfEnemyHitsPlayer(),this._checkEnemyHits(),this._playerShooting()),stage.update(a)},system.Game=createjs.promote(a,"Container")}();this.system=this.system||{},function(){"use strict";const a=function(a,b){this.Container_constructor(),this._init(a,b)},b=createjs.extend(a,createjs.Container);b._game=null,b._highscore=null,b._score=null,b._resetButton=null,b._init=function(a,b){this._game=a;const c=system.CustomMethods.makeImage("upgradePanelBack",!1,!1);this.addChild(c);const d=c.image.width/2,e=system.CustomMethods.makeText("GAME OVER","40px Teko","#ffffff","center","middle");e.x=d,e.y=35;const f=system.CustomMethods.makeText("Highscore","40px Teko","#ffffff","center","middle");f.x=d-150,f.y=90;const g=this._highscore=system.CustomMethods.makeText(b,"40px Teko","#ffff36","center","middle");g.x=f.x,g.y=f.y+50;const h=system.CustomMethods.makeText("Score","40px Teko","#ffffff","center","middle");h.x=d+150,h.y=f.y;const i=this._score=system.CustomMethods.makeText("0","40px Teko","#ffff36","center","middle");i.x=h.x,i.y=g.y;let j=system.CustomMethods.makeImage("resetButton",!0,!1);const k=this._resetButton=new system.Button(j);k.x=d,k.y=230,k.on("click",()=>{k.doScaleAnimation(),system.SoundManager.play("upgradeSelectSound"),this._game.onReset()}),this.addChild(e,f,g,h,i,k)},b.updateTextField=function(a,b){this[`_${a}`].text=`${b}`},b.enableButtons=function(a){this._resetButton.enableClick(a)},system.GameoverPanel=createjs.promote(a,"Container")}();this.system=this.system||{},function(){"use strict";const a=function(){};a.parameters={level1:{enemiesDamage:5,enemiesHealth:100,maxNumberOfActiveEnemies:3,maxNumberOfEnemies:5,color:"#ffffff",movementSpeed:2},level2:{enemiesDamage:6,enemiesHealth:105,maxNumberOfActiveEnemies:4,maxNumberOfEnemies:6,color:"#959595",movementSpeed:2},level3:{enemiesDamage:7,enemiesHealth:110,maxNumberOfActiveEnemies:4,maxNumberOfEnemies:7,color:"#d9d92e",movementSpeed:3},level4:{enemiesDamage:8,enemiesHealth:115,maxNumberOfActiveEnemies:5,maxNumberOfEnemies:8,color:"#ff981e",movementSpeed:3},level5:{enemiesDamage:9,enemiesHealth:120,maxNumberOfActiveEnemies:6,maxNumberOfEnemies:9,color:"#ff172d",movementSpeed:4},level6:{enemiesDamage:10,enemiesHealth:125,maxNumberOfActiveEnemies:7,maxNumberOfEnemies:10,color:"#ff8d9e",movementSpeed:4},level7:{enemiesDamage:11,enemiesHealth:130,maxNumberOfActiveEnemies:7,maxNumberOfEnemies:11,color:"#b60ad9",movementSpeed:4},level8:{enemiesDamage:12,enemiesHealth:135,maxNumberOfActiveEnemies:7,maxNumberOfEnemies:12,color:"#ff78f2",movementSpeed:4},level9:{enemiesDamage:13,enemiesHealth:140,maxNumberOfActiveEnemies:8,maxNumberOfEnemies:13,color:"#4dc8f6",movementSpeed:4},level10:{enemiesDamage:14,enemiesHealth:145,maxNumberOfActiveEnemies:8,maxNumberOfEnemies:14,color:"#5763ff",movementSpeed:4},level11:{enemiesDamage:15,enemiesHealth:150,maxNumberOfActiveEnemies:8,maxNumberOfEnemies:15,color:"#18ffce",movementSpeed:5},level12:{enemiesDamage:16,enemiesHealth:155,maxNumberOfActiveEnemies:8,maxNumberOfEnemies:16,color:"#1dff81",movementSpeed:5},level13:{enemiesDamage:17,enemiesHealth:160,maxNumberOfActiveEnemies:9,maxNumberOfEnemies:17,color:"#32ce33",movementSpeed:5},level14:{enemiesDamage:18,enemiesHealth:165,maxNumberOfActiveEnemies:9,maxNumberOfEnemies:18,color:"#97ce5f",movementSpeed:6},level15:{enemiesDamage:20,enemiesHealth:180,maxNumberOfActiveEnemies:10,maxNumberOfEnemies:20,color:"#97ce5f",movementSpeed:7}},a.getRandomColor=function(){const b=a.getNumberOfLevels(),c=system.CustomMethods.getRandomNumberFromTo(1,b);return a.parameters[`level${c}`].color},a.getParametersForLevel=function(b){return a.parameters[`level${b}`]},a.getNumberOfLevels=function(){return Object.keys(a.parameters).length},system.LevelParameters=a}();this.system=this.system||{},function(){"use strict";const a=function(){this.Container_constructor(),this._init()},b=createjs.extend(a,createjs.Container);b._START_SPEED=null,b._START_DAMAGE=null,b._START_HEALTH=null,b._START_COOLDOWN=null,b._DAMAGE_UPGRADES=null,b._HEALTH_UPGRADES=null,b._SPEED_UPGRADES=null,b._COOLDOWN_UPGRADES=null,b._damageUpgrades=null,b._healthUpgrades=null,b._speedUpgrades=null,b._cooldownUpgrades=null,b._speed=null,b._width=null,b._height=null,b._gun=null,b._gunImage=null,b._bulletSpeed=null,b._canShoot=null,b._damage=null,b._health=null,b._healthShape=null,b._healthColor=null,b._cooldown=null,b._highscore=null,b.bulletPoint=null,b._init=function(){this._START_DAMAGE=10,this._START_HEALTH=100,this._START_SPEED=6,this._START_COOLDOWN=300,this._DAMAGE_UPGRADES=[5,8,10,10,10,12],this._HEALTH_UPGRADES=[40,40,50,50,60,60],this._SPEED_UPGRADES=[1,1,2,2,3,3],this._COOLDOWN_UPGRADES=[50,50,50,50,50,50],this._cooldown=this._START_COOLDOWN;const a=this._highscore=JSON.parse(localStorage.getItem("highscore"));null===a&&localStorage.setItem("highscore",JSON.stringify(0));const b=64,c=64;this._healthColor="#5dff7c";const d=new createjs.Shape(new createjs.Graphics().setStrokeStyle(8).beginStroke("#5dff7c").drawRect(0,0,b,c));d.cache(0,0,b,c);const e=b-8,f=c-8,g=this._healthShape=new createjs.Shape(new createjs.Graphics().beginFill(this._healthColor).drawRect(0,0,e,f));g.cache(0,0,e,f),g.x=4,g.y=4,g.originalWidth=e,g.originalHeight=f,g.mouseEnabled=!1,this.addChild(d,g);const h=this._gunImage=system.CustomMethods.makeImage("playerGun",!1,!1),i=this._gun=new createjs.Container;i.regX=h.image.width/2,i.regY=h.image.height,i.x=d.bitmapCache.width/2,i.y=d.bitmapCache.height/2;const j=system.CustomMethods.makeImage("playerGunOverlay",!1,!0);j.x=h.image.width/2,j.y=h.image.height;const k=this.bulletPoint=system.CustomMethods.makeImage("bullet",!1,!1);k.x=4,k.y=-4e3,k.visible=!1,i.addChild(h,j,k),this.addChild(i),this._bulletSpeed=3e3,this._width=d.bitmapCache.width,this._height=d.bitmapCache.height,this._canShoot=!0,this._damage=this._START_DAMAGE,this._speed=this._START_SPEED,this._health=this._START_HEALTH,this.mouseChildren=!1,this._damageUpgrades=this._DAMAGE_UPGRADES.concat(),this._healthUpgrades=this._HEALTH_UPGRADES.concat(),this._speedUpgrades=this._SPEED_UPGRADES.concat(),this._cooldownUpgrades=this._COOLDOWN_UPGRADES.concat()},b.resetPlayer=function(){this._damage=this._START_DAMAGE,this._health=this._START_HEALTH,this._speed=this._START_SPEED,this._cooldown=this._START_COOLDOWN,this._updateHealthBar()},b.decreaseHealth=function(a){this._health-=a,this._updateHealthBar()},b.increasehealth=function(){this._health+=this._healthUpgrades.shift(),this._updateHealthBar()},b._updateHealthBar=function(){let a=system.CustomMethods.getPercentage(this._START_HEALTH,this._health);100<a&&(a=100);const b=this._healthShape.originalWidth,c=this._healthShape.originalHeight/100*a,d=0,e=this._healthShape.originalHeight-c;this._healthShape.uncache(),this._healthShape.graphics.clear().beginFill(this._healthColor).drawRect(d,e,b,c),this._healthShape.cache(d,e,b,c)},b.getHealth=function(){return this._health},b.getHealthColor=function(){return this._healthColor},b.increasedamage=function(){this._damage+=this._damageUpgrades.shift()},b.getDamage=function(){return this._damage},b.increasecooldown=function(){this._cooldown-=this._cooldownUpgrades.shift()},b.getCooldown=function(){return this._cooldown},b.doShootAnimation=function(){this._canShoot=!1,createjs.Tween.get(this._gunImage).to({y:15},100,createjs.Ease.circOut).to({y:0},100,createjs.Ease.circIn).wait(this._cooldown).call(()=>{this._canShoot=!0})},b.canShoot=function(){return this._canShoot},b.getBulletSpeed=function(){return this._bulletSpeed},b.rotateGun=function(a){this._gun.rotation=a},b.getDimension=function(){return{width:this._width,height:this._height}},b.increasespeed=function(){this._speed+=this._speedUpgrades.shift()},b.getSpeed=function(){return this._speed},b.getUpgradeValue=function(a){const b=`_${a}Upgrades`;return 0!==this[b].length&&this[b][0]},b.getStartingUpgradeValues=function(){return{damage:this._damageUpgrades[0],health:this._healthUpgrades[0],speed:this._speedUpgrades[0],cooldown:this._cooldownUpgrades[0]}},b.resetUpgrades=function(){this._damageUpgrades=this._DAMAGE_UPGRADES.concat(),this._healthUpgrades=this._HEALTH_UPGRADES.concat(),this._speedUpgrades=this._SPEED_UPGRADES.concat(),this._cooldownUpgrades=this._COOLDOWN_UPGRADES.concat()},b.setHighscore=function(a){this._highscore=a,localStorage.setItem("highscore",JSON.stringify(this._highscore))},b.getHighscore=function(){return this._highscore},system.Player=createjs.promote(a,"Container")}();this.system=this.system||{},function(){"use strict";const a=function(a){this.Container_constructor(),this._init(a)},b=createjs.extend(a,createjs.Container);b._damage=null,b._health=null,b._speed=null,b._cooldown=null,b._score=null,b._scoreNum=null,b._init=function(a){const b=system.CustomMethods.makeImage("playerStatsBack",!1,!1);this.addChild(b),this._scoreNum=0;const c=this._damage=system.CustomMethods.makeText(a.damage,"30px Teko","#000000","center","middle");c.y=35;const d=this._health=system.CustomMethods.makeText(a.health,"30px Teko","#000000","center","middle");d.y=105;const e=this._speed=system.CustomMethods.makeText(a.speed,"30px Teko","#000000","center","middle");e.y=175;const f=this._cooldown=system.CustomMethods.makeText(a.cooldown,"30px Teko","#000000","center","middle");f.y=245;const g=this._score=system.CustomMethods.makeText(this._scoreNum,"40px Teko","#46af57","center","middle");g.x=b.image.width/2,g.y=320,c.x=d.x=e.x=f.x=112,this.addChild(c,d,e,f,g)},b.updateTextField=function(a,b){this[`_${a}`].text=b},b.resetStats=function(a){this._scoreNum=0,this._damage.text=a.damage,this._health.text=a.health,this._speed.text=a.speed,this._cooldown.text=a.cooldown,this._score.text=0},b.increaseScore=function(a){this._scoreNum+=a,this.updateTextField("score",this._scoreNum)},b.getScore=function(){return this._scoreNum},system.PlayerStats=createjs.promote(a,"Container")}();this.system=this.system||{},function(){"use strict";const a=function(a,b){this.Container_constructor(),this._init(a,b)},b=createjs.extend(a,createjs.Container);b._game=null,b._buttons=null,b._damageIncrementerTxt=null,b._healthIncrementerTxt=null,b._speedIncrementerTxt=null,b._cooldownIncrementerTxt=null,b._init=function(a,b){this._game=a,this._buttons=[];const c=system.CustomMethods.makeImage("upgradePanelBack",!1,!1);this.addChild(c);const d=system.CustomMethods.makeText("CHOOSE UPGRADE","30px Teko","#ffffff","center","middle");d.x=c.image.width/2,d.y=46,this.addChild(d);const e=240;let f=system.CustomMethods.makeImage("damageButton",!0,!1);const g=new system.Button(f);g.setId("damage"),g.x=67,g.y=140,g.on("click",()=>{g.doScaleAnimation(),this._game.onUpgradeSelected("damage")});let h=this._damageIncrementerTxt=system.CustomMethods.makeText(`+${b.damage}`,"36px Teko","#ffffff","center","middle");h.x=g.x,h.y=e,f=system.CustomMethods.makeImage("healthButton",!0,!1);const i=new system.Button(f);i.setId("health"),i.x=200,i.y=140,i.on("click",()=>{i.doScaleAnimation(),this._game.onUpgradeSelected("health")});let j=this._healthIncrementerTxt=system.CustomMethods.makeText(`+${b.health}`,"36px Teko","#ffffff","center","middle");j.x=i.x,j.y=e,f=system.CustomMethods.makeImage("speedButton",!0,!1);const k=new system.Button(f);k.setId("speed"),k.x=333,k.y=140,k.on("click",()=>{k.doScaleAnimation(),this._game.onUpgradeSelected("speed")});let l=this._speedIncrementerTxt=system.CustomMethods.makeText(`+${b.speed}`,"36px Teko","#ffffff","center","middle");l.x=k.x,l.y=e,f=system.CustomMethods.makeImage("cooldownButton",!0,!1);const m=new system.Button(f);m.setId("cooldown"),m.x=466,m.y=140,m.on("click",()=>{m.doScaleAnimation(),this._game.onUpgradeSelected("cooldown")});let n=this._cooldownIncrementerTxt=system.CustomMethods.makeText(`-${b.cooldown}`,"36px Teko","#ffffff","center","middle");n.x=m.x,n.y=e,this.addChild(g,h,i,j,k,l,m,n),this._buttons.push(g,i,k,m)},b.updateTextField=function(a,b){let c="cooldown"===a?"-":"+";this[`_${a}IncrementerTxt`].text=`${c}${b}`},b.resetPanel=function(a){this._damageIncrementerTxt.text=`+${a.damage}`,this._healthIncrementerTxt.text=`+${a.health}`,this._speedIncrementerTxt.text=`+${a.speed}`,this._cooldownIncrementerTxt.text=`-${a.cooldown}`;for(let b=0;b<this._buttons.length;b++)this._buttons[b].visible=!0},b.enableButtons=function(a){this._buttons.forEach(b=>{b.enableClick(a)})},b.hideButton=function(a){for(let b=0;b<this._buttons.length;b++)if(this._buttons[b].buttonId===a){this._buttons[b].visible=!1;this[`_${a}IncrementerTxt`].text=""}},system.UpgradePanel=createjs.promote(a,"Container")}();this.system=this.system||{},function(){"use strict";const a=function(){this.Container_constructor(),this._init()},b=createjs.extend(a,createjs.Container);b._waveNumber=null,b._numberOfEnemies=null,b._numberOfActiveEnemies=null,b._enemiesDamage=null,b._enemiesHealth=null,b._init=function(){const a=system.CustomMethods.makeImage("waveInfo",!1,!0);this.addChild(a);const b=36,c=system.CustomMethods.makeText("Wave","30px Teko","#fff","center","middle");c.y=-215;const d=this._waveNumber=system.CustomMethods.makeText("0","30px Teko","#ffff36","center","middle");d.y=c.y+b;const e=system.CustomMethods.makeText("Enemies","30px Teko","#fff","center","middle");e.y=c.y+100;const f=this._numberOfEnemies=system.CustomMethods.makeText("0","30px Teko","#ffff36","center","middle");f.y=e.y+b;const g=system.CustomMethods.makeText("Active Enemies","30px Teko","#fff","center","middle");g.y=e.y+100;const h=this._numberOfActiveEnemies=system.CustomMethods.makeText("0","30px Teko","#ffff36","center","middle");h.y=g.y+b;const i=system.CustomMethods.makeText("Enemies Damage","30px Teko","#fff","center","middle");i.y=g.y+100;const j=this._enemiesDamage=system.CustomMethods.makeText("0","30px Teko","#ffff36","center","middle");j.y=i.y+b;const k=system.CustomMethods.makeText("Enemies Health","30px Teko","#fff","center","middle");k.y=i.y+100;const l=this._enemiesHealth=system.CustomMethods.makeText("0","30px Teko","#ffff36","center","middle");l.y=k.y+b,this.addChild(c,d,e,f,g,h,i,j,k,l)},b.updateTextFields=function(a){this._waveNumber.text=a.waveNumber,this._numberOfEnemies.text=a.numberOfEnemies,this._numberOfActiveEnemies.text=a.numberOfActiveEnemies,this._enemiesDamage.text=a.enemiesDamage,this._enemiesHealth.text=a.enemiesHealth,console.log(`info ${a.enemiesHealth}`)},system.WaveInfo=createjs.promote(a,"Container")}();